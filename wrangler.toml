# Base configuration
name = "zxcv-backend-and-frontend"
main = "./.output/server/index.mjs"
compatibility_date = "2025-09-15"
compatibility_flags = ["nodejs_compat"]

[observability]
enabled = true

# Production configuration (default)
[[d1_databases]]
binding = "DB"
database_name = "zxcv-db"
database_id = "ee2c13b9-0d5b-49ea-9bf4-5a65e2f7ad4e"

[[r2_buckets]]
binding = "R2"
bucket_name = "zxcv"

[vars]
# Non-secret configuration for production
# Secrets (JWT_SECRET, GOOGLE_CLIENT_ID, etc.) are set via wrangler secret during deployment
JWT_ALGORITHM = "HS256"
JWT_EXPIRES_IN = "7d"
RATE_LIMIT_ANONYMOUS = "100"
RATE_LIMIT_AUTHENTICATED = "1000"
RATE_LIMIT_API_KEY = "5000"
ENVIRONMENT = "production"

[placement]
mode = "smart"

# Workers Assets configuration
[assets]
binding = "ASSETS"
directory = ".output/public"

# Staging environment configuration
[env.staging]
name = "zxcv-backend-and-frontend-staging"

[[env.staging.d1_databases]]
binding = "DB"
database_name = "zxcv-staging"
database_id = "e3bce64a-4462-4812-a343-c04c3ba7032a"

[[env.staging.r2_buckets]]
binding = "R2"
bucket_name = "zxcv-staging"

[env.staging.vars]
# Staging environment configuration (vars are NOT inherited, must be redefined)
JWT_ALGORITHM = "HS256"
JWT_EXPIRES_IN = "7d"
RATE_LIMIT_ANONYMOUS = "100"
RATE_LIMIT_AUTHENTICATED = "1000"
RATE_LIMIT_API_KEY = "5000"
ENVIRONMENT = "staging"

# Workers Assets configuration for staging
[env.staging.assets]
binding = "ASSETS"
directory = ".output/public"

